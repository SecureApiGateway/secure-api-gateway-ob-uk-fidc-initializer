[
  {
    "operation": "add",
    "field": "objects/-",
    "value":    {
      "name": "alpha_role",
      "onDelete": {
        "type": "text/javascript",
        "file": "roles/onDelete-roles.js"
      },
      "postCreate": {
        "type": "text/javascript",
        "source": "require('roles/postOperation-roles').manageTemporalConstraints(resourceName);"
      },
      "postUpdate": {
        "type": "text/javascript",
        "source": "require('roles/postOperation-roles').manageTemporalConstraints(resourceName);"
      },
      "postDelete": {
        "type": "text/javascript",
        "source": "require('roles/postOperation-roles').manageTemporalConstraints(resourceName);"
      },
      "schema": {
        "id": "urn:jsonschema:org:forgerock:openidm:managed:api:Role",
        "$schema": "http://forgerock.org/json-schema#",
        "type": "object",
        "title": "Alpha realm - Role",
        "icon": "fa-check-square-o",
        "mat-icon": "assignment_ind",
        "description": "",
        "properties": {
          "_id": {
            "description": "Role ID",
            "title": "Name",
            "viewable": false,
            "searchable": false,
            "type": "string"
          },
          "name": {
            "description": "The role name, used for display purposes.",
            "title": "Name",
            "viewable": true,
            "searchable": true,
            "type": "string"
          },
          "description": {
            "description": "The role description, used for display purposes.",
            "title": "Description",
            "viewable": true,
            "searchable": true,
            "type": "string"
          },
          "members": {
            "description": "Role Members",
            "title": "Role Members",
            "viewable": true,
            "type": "array",
            "returnByDefault": false,
            "relationshipGrantTemporalConstraintsEnforced": true,
            "items": {
              "type": "relationship",
              "id": "urn:jsonschema:org:forgerock:openidm:managed:api:Role:members:items",
              "title": "Role Members Items",
              "reverseRelationship": true,
              "reversePropertyName": "roles",
              "validate": true,
              "properties": {
                "_ref": {
                  "description": "References a relationship from a managed object",
                  "type": "string"
                },
                "_refProperties": {
                  "description": "Supports metadata within the relationship",
                  "type": "object",
                  "title": "Role Members Items _refProperties",
                  "properties": {
                    "_id": {
                      "description": "_refProperties object ID",
                      "type": "string"
                    },
                    "_grantType": {
                      "description": "Grant Type",
                      "type": "string",
                      "label": "Grant Type"
                    }
                  }
                }
              },
              "resourceCollection": [
                {
                  "notify": true,
                  "conditionalAssociation": true,
                  "path": "managed/alpha_user",
                  "label": "User",
                  "query": {
                    "queryFilter": "true",
                    "fields": ["userName", "givenName", "sn"]
                  }
                }
              ]
            }
          },
          "assignments": {
            "description": "Managed Assignments",
            "title": "Managed Assignments",
            "viewable": true,
            "returnByDefault": false,
            "type": "array",
            "items": {
              "type": "relationship",
              "id": "urn:jsonschema:org:forgerock:openidm:managed:api:Role:assignments:items",
              "title": "Managed Assignments Items",
              "reverseRelationship": true,
              "reversePropertyName": "roles",
              "notifySelf": true,
              "validate": true,
              "properties": {
                "_ref": {
                  "description": "References a relationship from a managed object",
                  "type": "string"
                },
                "_refProperties": {
                  "description": "Supports metadata within the relationship",
                  "title": "Managed Assignments Items _refProperties",
                  "type": "object",
                  "properties": {
                    "_id": {
                      "description": "_refProperties object ID",
                      "type": "string"
                    }
                  }
                }
              },
              "resourceCollection": [
                {
                  "path": "managed/alpha_assignment",
                  "label": "Assignment",
                  "query": {
                    "queryFilter": "true",
                    "fields": ["name"]
                  }
                }
              ]
            },
            "notifyRelationships": ["members"]
          },
          "condition": {
            "description": "A conditional filter for this role",
            "title": "Condition",
            "viewable": false,
            "searchable": false,
            "isConditional": true,
            "type": "string"
          },
          "temporalConstraints": {
            "description": "An array of temporal constraints for a role",
            "title": "Temporal Constraints",
            "viewable": false,
            "returnByDefault": true,
            "isTemporalConstraint": true,
            "type": "array",
            "items": {
              "type": "object",
              "title": "Temporal Constraints Items",
              "properties": {
                "duration": {
                  "description": "Duration",
                  "type": "string"
                }
              },
              "required": ["duration"],
              "order": ["duration"]
            },
            "notifyRelationships": ["members"]
          }
        },
        "required": ["name"],
        "order": [
          "_id",
          "name",
          "description",
          "members",
          "assignments",
          "condition",
          "temporalConstraints"
        ]
      }
    }
  }
]